%
%  Introduction
% ==============
%

\chapter{Introduction}
\label{Ch:Intro}

The Advanced Wakefield Experiment (AWAKE) \cite{awake_collaboration:2014}, located at the old CNGS\footnote{The CERN Neutrinos to Gran Sasso (CNGS) experiment was operational between 2006 and 2012.} facility at CERN, became operational in December 2016. It is a proof-of-concept Proton Driven Plasma Wakefield Accelerator (PDPWFA) using the proton beam from the Super Proton Synchrotron (SPS) as its drive beam.

AWAKE is currently in Run 1 where the interaction between the proton drive beam and the plasma will be studied, and where a long electron witness beam will be injected to sample the wakefields. Run 2 is planned to start after the next Long Shutdown of the LHC (LS2) scheduled for 2019 and 2020, when significant upgrades will be made to the experiment. Run 2 will attempt to accelerate a short, intense electron beam to high energy while avoiding growth in emittance and large energy spread. In preparation for Run 2, a number of design choices needs to be made based on the results of Run 1 as well as simulations of Run 2. The work presented in this thesis primarily focuses on the beam loading of a short electron witness beam through simulations, in preparation for AWAKE Run 2.

The key results are presented in Publication \ref{Pub:BL17}, with the studies leading up to this presented in two conference papers: Publication \ref{Pub:IPAC15} and \ref{Pub:NAPAC16}. A third conference paper, Publication \ref{Pub:IPAC17}, covers the integration of the AWAKE experiment with the CERN control system, which is the main contribution to Run 1 in this PhD project.

In this chapter we will first cover some of the key concepts involved in plasma wakefield acceleration techniques relevant to the work presented in this thesis. The design of the AWAKE experiment itself is laid out in more detail in the next chapter, and the framework for the simulations is described in the third chapter. The fourth chapter outlines the work done in integrating AWAKE Run 1 with the control system at CERN.

% ================================================================================================ %
\section{Plasma Wakefield Acceleration}
\label{Int:PWFA}

Accelerating particle beams in a plasma is an attractive concept as plasmas are capable of sustaining significantly higher accelerating fields than RF structures used in conventional accelerators can. Such RF structures suffer electrical breakdowns at very high electric fields, and these breakdowns can over time damage the structures \cite{braun:2003}. This puts an upper limit on the accelerating gradient of about $350$ to $400\unit{MV/m}$. As these breakdowns causes damage to the surfaces of the RF cavities, in practice the upper limit is determined by the statistical probability of a breakdown and the acceptable number of breakdowns in a given period of time \cite{pritzkau:2002}, and the practical limit is therefore lower.

While RF cavities use standing electromagnetic waves to accelerate particles, plasma accelerators use an energetic beam to drive strong electromagnetic wakefields in the plasma. The two main techniques for producing these strong accelerating fields are by the use of an intense laser beam, or by the use of a particle drive beam. Laser accelerator techniques were investigated in the early 1970s \cite{chan:1971, palmer:1972}, and wakefield acceleration techniques through the use of computer simulations at the end of the decade \cite{tajima:1979}. Using particle beams to drive accelerating wakefields were proposed some time later, in 1985 \cite{chen:1985}.

Both these beam and laser driver techniques utilise a neutral plasma where the collective motion of the free electrons define the main parameters of the accelerating structure. The characteristic time of the electron motion is related to the plasma frequency, $\omega_{pe}$, and the characteristic length is related to the plasma wavelength, $\lambda_{pe}$.
\begin{equation}
    \lambda_{pe} = \frac{2\pi c}{\omega_{pe}}, \quad
    \omega_{pe}  = \sqrt{\frac{n_{0}e^{2}}{m_{e}\epsilon_{0}}}, \label{EQ:PWFA:L0W0}
\end{equation}
where $n_{0}$ is the initial plasma electron density, $e$ is the elementary charge, $m_{e}$ is the electron mass, and $\epsilon_{0}$ is the vacuum permittivity \cite{tonks:1929, esarey:1996, pecseli:2012}. Here we ignore the ion mass and we assume the plasma is cold, i.e. we ignore the thermal motion of the electrons. The characteristic time and length of ion motion scales as the square root of the mass difference compared to the plasma electrons and tend, depending on the ion mass, to be a few orders of magnitude longer than those of the electrons. In the case of very long accelerating structures, the motion of the ions may become an issue.

Plasmas can in general sustain accelerating electric fields on the order of the non-relativistic wave-breaking field \cite{dawson:1959, esarey:1996}
\begin{equation}
    E_{\mathrm{WB}} = \frac{m_{e} c \omega_{pe}}{e}. \label{EQ:EWB}
\end{equation}
For instance, for a plasma density of $10^{18}\unit{cm}^{-3}$, the maximum field is on the order of $100\unit{GV/m}$. This has been inferred by experiment in the mid 1990s when a few electrons was accelerated to over $40\unit{MeV}$ in about $300\unit{\mu m}$ of Helium plasma, driven by a $25\unit{TW}$ pico second laser \cite{modena:1995}.

Both techniques require a drive beam that deposits energy into the plasma in the form of wakefields. The drive beam is trailed by another beam which draws energy from the fields in order to accelerate. We thus see a transfer of energy from the drive beam to the witness beam through plasma as the intermediate medium \cite{muggli:2009}. Let us briefly introduce the core principle of the two methods of plasma wakefield acceleration. 

% ================================================================================================ %
\subsection{Laser Driven Acceleration}
\label{Int:LWFA}

In a laser wakefield driven plasma accelerator (LWFA), the plasma acts like a transformer, changing high frequency transverse field of the laser pulse into a low frequency longitudinal wave \cite{malka:2009}. The effect driving the accelerating fields was described by Tajima and Dawson in 1979, and can be summarised as follows: The ponderomotive force at the front of the laser pulse drives plasma electrons forward, while at the back of the pulse it pushes them backwards. This generates a longitudinal wave that is at its most efficient when the length of the laser pulse $L_{ph} = \lambda_{pe}/2$ \cite{tajima:1979}. The longitudinal field is then loaded by a trailing particle beam to be accelerated, or in some instances plasma electrons are being captured and accelerated instead.

% ================================================================================================ %
\subsection{Beam Driven Acceleration}
\label{Int:BDPWFA}

In a beam driven plasma wakefield acceleration (PWFA) a drive beam of charged particles are sent through a section of neutral plasma. The space charge of the drive beam displaces the plasma electrons, which oscillate at the plasma frequency, creating periodic regions of low and high electron density generating strong wakefields. The longitudinal and transverse fields generated by this wake is then loaded by a trailing beam of particles. The principles behind this technique were formulated in the 1980s by Pisin Chen \emph{et al.} \cite{chen:1985}.

Any type of charged particle beam can be used in such an accelerator. Most experiments to date have used electrons. It has been shown that energy can be transferred from one or more electron drive beams to a single electron witness beam in multiple past experiments \cite{rosenzweig:1988, blumenfeld:2007, kallos:2008, litos:2014}. In one experiment at the Stanford Linear Accelerator Center (SLAC), a $42\unit{GeV}$ electron beam passing through an $85\unit{cm}$ section of ionised Lithium vapour, saw the trailing part of the electron beam reach $85\unit{GeV}$. This corresponds to a gradient of $52\unit{GV/m}$ \cite{blumenfeld:2007}.

A limitation using an electron beam with a similar initial charge and energy for both drive and witness beams is that the witness beam will rapidly gain energy, while the drive beam loses energy. This both causes the drive beam to quickly decelerate, while the witness beam undergoing acceleration will at the same time catch up with the drive beam. Typically propagation length of an electron drive beam is a few tens of centimetres of plasma.

% ================================================================================================ %
\section{Beam-Plasma Interaction}
\label{Int:BPI}

As a relativistic, charged beam propagates through plasma, it affects the local density of the plasma electrons. The charged beam generates strong transverse fields, pushing or pulling the plasma electrons away or towards the propagation axis of the beam \cite{lee:2001,adli:2016b}. As the heavier plasma ions will move one a much longer time scale, due to inertia, the plasma electrons expelled from the axis will be pulled back towards it by the ion charge. The electrons will tend to overshoot the axis, creating an oscillation system. A positively charged drive beam will initially pull the electrons towards the axis, where they overshoot, creating a similar effect to a negative drive beam with a half-period phase offset. The oscillation period is determined by the plasma wavelength of the electrons \cite{hogan:2016,muggli:2017}. An illustration of an electron beam travelling though a plasma is shown in Figure \ref{Fig:PWFA:Illust}.

\begin{figure}[hbt]
    \centering
    \includegraphics[width=0.85\linewidth,trim={0mm 0mm 0mm 0mm},clip]{figures/PlasmaWakefield}
    \caption{\label{Fig:PWFA:Illust} Illustration of a plasma wakefield accelerating structure with a single electron drive beam. A series of focusing/defocusing and accelerating/deceleratring regions (as seen for an electron witness beam) are produced behind the drive beam.}
\end{figure}

% ================================================================================================ %
\subsection{The Drive Beam}
\label{Int:BPI:Drive}

The wakefields generated by a charged drive beam are given by the Lorentz force
\begin{equation}
    \vec{W} = \frac{\vec{F}}{q_{b}} = \vec{E} + \vec{v}_{b} \times \vec{B}, \label{EQ:Lorentz}
\end{equation}
where $q_{b}$ is the beam charge and $\vec{v}_{b}$ is the beam velocity. We define the longitudinal coordinate in the frame of the beam along its direction of propagation as
\begin{equation}
    \xi \equiv z - v_{b}t \approx z - ct, \label{EQ:Xi}
\end{equation}
and for the purpose of the following derivations, we use a cylindrical coordinate system $(r, \xi)$. It follows, then, that the longitudinal wakefield is only determined by the longitudinal component of the electric field \dash to the first order \dash such that
\begin{equation}
    W_{\parallel}(r,\xi) = E_{z}(r,\xi). \label{EQ:Wz}
\end{equation}
The transverse wakefield, on the other hand, also depends on the magnetic field such that
\begin{equation}
    W_{\perp}(r,\xi) = E_{r}(r,\xi) - cB_{\theta}(r,\xi), \label{EQ:Wr}
\end{equation}
where we again take the velocity of the beam to be $v_{b} \approx c$.

A charged beam will diverge and lengthen due to space charge, but since the beam is relativistic the effect is of no significance over a few metres of plasma. Dephasing $\Delta L$ over a distance $L$ can be estimated as
\begin{equation}
    \frac{\Delta L}{L} \approx \frac{1}{\gamma^{2}}\frac{\Delta\gamma}{\gamma} \label{EQ:DePhL}
\end{equation}
for two sample particles with energy difference $\Delta\gamma$ \cite{muggli:2017}. In the transverse plane, however, the beam is subject to the Lorentz force given by the transverse component of Eq. \ref{EQ:Lorentz}. Taking Maxwell's equations and $B_{\theta} = v_{b}E_{r}/c^{2}$ \cite{schindl:1999}, the strength can be estimated using an infinitely long, uniform beam of density $n_{b}$:
\begin{equation}
    F_{\perp} = q_{b}(E_{r} - v_{b}B_{\theta})
              = q_{b}E_{r}\left(1 - \frac{v_{b}^{2}}{c^{2}}\right)
              = \frac{1}{\gamma^2}q_{b}E_{r}. \label{EQ:DeFocR}
\end{equation}
The implication being that for relativistic beams, the transverse dynamics are dominated by emittance and external forces \cite{muggli:2017}.

% ================================================================================================ %
\subsection{The Linear Regime}
\label{Int:BPI:Lin}

When the charge density of the beam is smaller than that of the plasma, $n_{b} \ll n_{pe}$, the system is in the \textit{linear regime}. The linear regime is not of much interest for accelerator applications as it does not produce strong wakefields, and the transverse and longitudinal fields have continuous variations. These variations will strongly affect the energy spread and emittance of the witness beam. However, this regime is interesting from a theoretical perspective because it is well described analytically \cite{muggli:2017}.

A linear theory for plasma accelerators can be derived using a cold, non-relativistic fluid model of the plasma. The response of the cold plasma can be found from the linearised equations of motion and continuity, and the Maxwell equations. (For examples of linearisation, see \cite{pecseli:2012,chen:1974}.) The equations of motion and continuity are linearised assuming the perturbed plasma density, $n_{1}$, is much smaller than the unperturbed density, $n_{0} = n_{pe}$ \cite{chen:1987}. By further combining the fluid equation and the Poisson equation \cite{katsouleas:1987}, a wave equation for for the plasma density perturbation by the beam can be derived \cite{chen:1987,muggli:2017}:
\begin{equation}
    \frac{\partial^{2}}{\partial\xi^{2}}n_{1} + k_{pe}^{2}n_{1} = \frac{q_{b}}{e}k_{pe}^{2}n_{b}, \label{EQ:BeamPlasmaWF}
\end{equation}
where we still assume $n_{b} \ll n_{pe}$.

The solution to Eq. \ref{EQ:BeamPlasmaWF} in the longitudinal dimension is the Green’s function for a harmonic oscillator in 1D \cite{katsouleas:1987}, and the radial dependency can be calculated from 2D theory for different radial profiles \cite{chen:1987}. For a beam that has a Gaussian profile in both dimensions, the wakefields are
\begin{align}
    W_{\parallel}(r,\xi) &= \frac{e}{\epsilon_{0}}
        \int_{-\infty}^{\xi} n_{b\parallel}(\xi^{\prime}) \cos\left[k_{pe}(\xi-\xi^{\prime})\right] \deriv{\xi^{\prime}} \,\cdot\, R(r) \label{EQ:WzFull} \\
    W_{\perp}(r,\xi) &= \frac{e}{\epsilon_{0}k_{pe}}
        \int_{-\infty}^{\xi} n_{b\parallel}(\xi^{\prime}) \sin\left[k_{pe}(\xi-\xi^{\prime})\right] \deriv{\xi^{\prime}} \,\cdot\, \frac{\mathrm{d}}{\mathrm{d}r}R(r), \label{EQ:WrFull}
\end{align}
where the transverse dependency $R(r)$ is
\begin{align}
    R(r) &= k_{pe}^{2} \int_{0}^{r} n_{b\perp}(r^{\prime}) I_{0}(k_{pe}r^{\prime})
           K_{0}(k_{pe}r) \,r^{\prime}\deriv{r}^{\prime} \nonumber \\
         &+ k_{pe}^{2} \int_{r}^{\infty} n_{b\perp}(r^{\prime}) I_{0}(k_{pe}r)
           K_{0}(k_{pe}r^{\prime}) \,r^{\prime}\deriv{r}^{\prime}. \label{EQ:WFRadial}
\end{align}
Here $I_{0}$ and $K_{0}$ are the zeroth-order modified Bessel functions of the first and second kind, respectively \cite{chen:1987,muggli:2017}.

\begin{figure}[hbt]
    \centering
    \includegraphics[width=0.70\linewidth,trim={0mm 0mm 0mm 0mm},clip]{figures/RepKatsouleas1987}
    \caption{\label{Fig:BPI:Kat87} The radial function $R(r)$ for a range of uniform beams cut of at a radius $a$ up to twice the plasma skin depth $k_{pe}$. The plot is reproduced from Katsouleas \textit{et al.} \cite{katsouleas:1987}.}
\end{figure}

As can be seen from Figure \ref{Fig:BPI:Kat87}, the longitudinal wakefield is at its maximum on-axis. For very wide beams, $\sigma_{r} \gg k_{pe}$, we converge at the 1D result as we expect. For very narrow beams, $\sigma_{r} \gg k_{pe}$, the maximum decreases rapidly with radius causing different parts of the witness beam at different radii to see different accelerating fields. The cosine component of Eq. \ref{EQ:WzFull} also implies longitudinal variations of the accelerating field. Combined, these produce a large energy spread for the accelerating beam. Additional, the sinusoidally varying focusing field from Eq. \ref{EQ:WrFull} produces emittance growth \cite{muggli:2017,katsouleas:1987}.

% Cite \cite{ruth:1985}

% ================================================================================================ %
\subsection{The Non-Linear Regime}
\label{Int:BPI:NLin}

In the non-linear regime, also referred to as the \textit{blowout} regime in the literature, the plasma electrons are expelled from the region around the axis to form a region populated by only plasma ions. As the ions are practically stationary on the time scale of the plasma electrons, they form a uniform column of positive charge. The electrons displaced by the space charge of the drive beam are pulled back on axis by the ions, within the characteristic time $\omega_{pe}^{-1}$, to form a thin sheath of electrons with the shape of a bubble \cite{lu:2006a,lu:2006}. Hence, this is also sometimes referred to as the \textit{bubble} regime or the \textit{blow out} regime.

A conceptual illustration of an electron beam driven plasma accelerator is shown in Fig. \ref{Fig:PWFA:Illust}. Several regions of decreasing magnitude of accelerating/decelerating and focusing/defocusing are generated behind the drive beam. By positioning a trailing beam in an optimal phase, such a beam can both accelerated and focused. The drive beam needs to be shorter than the plasma period for this structure to develop, but multiple short drive beams with a separation of the plasma wave length can amplify the wakefields.

% ================================================================================================ %
\subsection{Beam Matching}
\label{Sim:Match}

In the non-linear case where an ion column is formed, the focusing force it produces will cause a pinching effect on the beam. The beam itself, assuming $\emitN > 0$, will cause the beam to try to expand. There exists a beam radius where the focusing force and the beam's tendency to expand are in equilibrium. For a highly relativistic beam, $\gammar \gg 1$, the equilibrium radius is given by \cite{krall:1995}
\begin{equation}
    R_{\mathrm{eq}} = \left( 8 \frac{\emitN^2}{\gammar} \frac{c^2}{\omega_{p}^2} \right)^{1/4}. \label{EQ:Sim:Req}
\end{equation}

Equation \ref{EQ:Sim:Req} follows from the general enevolpe equation \cite{lee:1976} under the assumption that the beam enters the plasma at focus (i.e. $\deriv{\sigma_{r}}/\deriv{z} = 0$), does not diverge significantly from a Gaussian transverse density profile, and that the focusing force is linear \cite{krall:1995} \dash the latter being the case in the blow-out regime.

% ================================================================================================ %
\section{Protons vs. Electrons as Drive Beam}
\label{Int:PDPWFA}

Further details on proton driven plasma wakefield goes here.

Benefit of larger energy per bunch, challenge of producing short bunches.

Cite \cite{adli:2016a}.

% ================================================================================================ %
\section{The Self-modulation Instability}
\label{Int:SMI}

A long beam with respect to the plasma wavelength will generate a density wave driven by its own head. This is true for both laser beams \cite{esarey:1994} and particle beams \cite{kumar:2010}, and they are caused by the same underlying physics. For a laser beam, this produces alternating regions of focusing and diffraction. For a particle beam, the wakefields generated within the beam acts back on itself, breaking it up into short micro bunches with a surrounding, defocused halo.

In the 1980s, this self-modulating effect was taken advantage of in LWFA experiments as only long laser pulses were available. Advances in ultra short laser technology later removed the dependence of this effect \cite{pukhov:2002}, however for proton drive beams this is still an issue. For instance, the SPS proton beam used by AWAKE is orders of magnitude longer than the plasma wavelength needed for the experiment.

The self-modulation instability (SMI), is one of several instabilities affecting long beams in plasma.

% To add: Phase velocity of SMI WF. Two-stream and hosing.

In electron beam \cite{muggli:2014}.

% ================================================================================================ %
\section{Numerical Simulations of PWFA}
\label{Int:Sim}

PIC codes. Osiris vs, QuickPIC.

Numerical Cherenkov, Lehe. Relevance to emittance.

Reference to PIC appendix.

Maybe something about resolution and convergence.

% ================================================================================================ %
